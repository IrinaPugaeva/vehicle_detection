# vehicle_detection


EDA и промежуточные выводы в ноутбуке (ниже кратко):


После визуализации нескольких случайных кадров внутри и вне тайм-маркеров возникла идея решения задачи обнаружения транспорта в полигоне через задачу бинарной классификации:
- Кадры внутри тайм-маркера с транспортом классифицируем как `1`.
- Кадры вне тайм-маркера классифицируем как `0`.

#### Решение и Методология
- Вырезаем полигон, заполняем его белым цветом и классифицируем.
- В случае дисбаланса классов применяем взвешивание классов.
- Исключаем из датасета видео №4, так как на нём транспорт практически не попадает в полигон (для `time_intervals`).

#### Данные
- Всего получилось кадров: 1391.
- Выборка почти сбалансирована по кадрам:
  - 596 кадров с транспортным средством внутри полигона.
  - 795 кадров без транспортного средства внутри полигона.

#### Модель
- Потюнила в течение 15 эпох модель EfficientNet-B1 + классификационная голова

#### Метрика
- Используем `f1_score` в качестве основной метрики, так как она учитывает как точность (precision), так и полноту (recall). В зависимости от бизнес-задачи можно уделять большее внимание либо точности, либо полноте
- Полученный `f1_score`: 0.74.

#### Выводы
- Качество модели сильно зависит от разделения на тренировочную и тестовую выборки, что указывает на разнообразие данных.
- Для повышения качества модели имеет смысл использовать кросс-валидацию и комбинацию нескольких моделей для получения более робастного решения.

### Скрипты

#### `trainer.py`
- Содержит класс `Trainer`, используемый для обучения модели на задаче классификации транспортных средств.
- Обрабатывает весь процесс обучения, включая загрузку данных, обучение модели и валидацию.

#### `inference.py`
- Используется для выполнения предсказаний с помощью обученной модели.
- Загружает модель, обрабатывает входные данные и выводит предсказания.

#### Запуск Предсказаний
`python inference.py ../videos/video_18.mp4 ../polygons.json ../output.json`



